<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport"
         content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, viewport-fit=cover">
      <meta name="apple-mobile-web-app-capable" content="yes">
      <meta name="apple-mobile-web-app-status-bar-style" content="default">
      <meta name="theme-color" content="#ffffff">
      <!-- Your app title -->
      <title>Yui Mobile</title>
      <link rel="stylesheet" href="css/framework7-bundle.css">
      <link rel="stylesheet" href="css/framework7-icons.css">
      <link rel="stylesheet" href="css/style%EF%B9%96v=2.css">
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-storage.js"></script>
<!-- Your script here -->

      <script src="https://cdnjs.cloudflare.com/ajax/libs/Faker/3.1.0/faker.min.js"></script>

      <script src="https://unpkg.com/sweetalert@2.1.2/dist/sweetalert.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
      <script>
         // Your web app's Firebase configuration
const firebaseConfig = {
    apiKey: "AIzaSyDr6DJyEqw_7WBx5LZRykN3bKGUDGYOX_0",
    authDomain: "m-bdswiss.firebaseapp.com",
    databaseURL: "https://m-bdswiss-default-rtdb.firebaseio.com",
    projectId: "m-bdswiss",
    storageBucket: "m-bdswiss.appspot.com",
    messagingSenderId: "333486800922",
    appId: "1:333486800922:web:4df3ba32f952b3551491a3",
    measurementId: "G-M1LHL1975Q"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);
var db = firebase.firestore();
var storage = firebase.storage();

      </script>
   </head>
   <body class="color-blue">
      <!-- App root element -->
      <div id="app">
         <!-- Left panel -->
         <div class="panel panel-left panel-push panel-init">
            <div class="profile-header">
               <div class="profile-image">
                  <img src="img/avatars/1.jpg" alt="">
                  <div class="profile-online bg-color-green"></div>
               </div>
               <div class="profile-name">Noah Campbell</div>
               <div class="profile-subtitle"><a href="../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="b6d8d5d7dbd4c6d3dadaf6d3d8c0d7c2d998d5d9db">[email&#160;protected]</a></div>
            </div>
            <div class="list links-list panel-links">
               <ul>
                  <li>
                     <a href="https://yui.xioyuna.com/profile/" class="panel-close">
                     <i class="icon f7-icons">person_crop_circle_fill</i>
                     My Profile
                     </a>
                  </li>
                  <li>
                     <a href="notifications" class="panel-close">
                     <i class="icon f7-icons">bell_fill</i>
                     Notifications
                     </a>
                  </li>
                  <li>
                     <a href="settings" class="panel-close">
                     <i class="icon f7-icons">gear_alt_fill</i>
                     Settings
                     </a>
                  </li>
                  <li>
                     <a href="https://yui.xioyuna.com/messages/" class="panel-close">
                     <i class="icon f7-icons">bubble_left_bubble_right_fill</i>
                     Messages
                     </a>
                  </li>
                  <li>
                     <a href="https://yui.xioyuna.com/search/" class="panel-close">
                     <i class="icon f7-icons">search_circle_fill</i>
                     Search
                     </a>
                  </li>
                  <li>
                     <a href="https://yui.xioyuna.com/help-center/" class="panel-close">
                     <i class="icon f7-icons">question_square_fill</i>
                     Help Center
                     </a>
                  </li>
               </ul>
            </div>
            <div class="panel-logout">
               <a href="#" class="link text-color-red">
               Log Out
               <i class="icon f7-icons arrow-back text-color-red">square_arrow_right</i>
               </a>
            </div>
         </div>
         <!-- Views container -->
         <div class="views tabs">
           




            <div class="view view-main tab" id="tab-1">
               <div class="page">
                  <div class="navbar navbar-large">
                     <div class="navbar-bg"></div>
                     <div class="navbar-inner">
                        <div class="left">
                           <a href="settings" class="link icon-only navbar-profile">
                           <img src="img/avatars/small-avatar.jpg" alt="">
                           </a>
                        </div>
                        <div class="title">Discover</div>
                        <div class="title-large">
                           <div class="title-large-text">Discover</div>
                        </div>
                        <div class="right">
                           <a href="#" class="link icon-only switch-theme theme-switcher">
                           <i class="icon f7-icons">moon_stars</i>
                           </a>
                           <a href="notifications" class="link icon-only">
                           <i class="icon f7-icons">
                           bell
                           <span class="badge bg-color-primary">5</span>
                           </i>
                           </a>
                        </div>
                     </div>
                  </div>






                  <div class="page-content">


                     <div class="section-title">Don't Miss It!</div>
                     <a href="https://yui.xioyuna.com/single/" class="card">
                        <div class="card-image">
                           <img src="img/cards/8.jpg" alt="">
                        </div>
                     </a>



                     <swiper-container id="boooks" class="full-width" slides-per-view="2.4" space-between="15" slides-offset-after="15" slides-offset-before="15" speed="400">
                     </swiper-container>
                     <script>
                        var swiperContainer = document.querySelector('#boooks');
                        
                        db.collection('books')
                            .orderBy('timestamp', 'desc')
                            .limit(4)
                            .get()
                            .then((querySnapshot) => {
                                querySnapshot.forEach((doc) => {
                                    var book = doc.data();
                                    var swiperSlide = document.createElement('swiper-slide');
                                    swiperSlide.setAttribute("id", "boooks-slider");
                                    swiperSlide.innerHTML = `
                                        <a href="book.html?id=${doc.id}"  class="card card-movie external">
                                            <div class="card-image">
                                                <img src="${book.cover}" alt="${book.title}">
                                                <div class="card-movie-rating">
                                                    <i class="icon f7-icons text-color-yellow">star_fill</i>
                                                </div>
                                            </div>
                                        </a>
                                    `;
                                    swiperContainer.appendChild(swiperSlide);
                                });
                            })
                            .catch(error => console.error(error));
                     </script>
                     <div class="section-title">
                        Album Releases
                        <a href="" class="link">View All</a>
                     </div>
                     <div id="users" class="grid grid-cols-2 album-grid">
                     </div>
                     <script>
        var authorsContainer = document.querySelector('#users');
                        
var authorsContainer = document.querySelector('#users');
                        
db.collection('users')
    .orderBy("username") // assumes 'username' as the field to sort by
    .limit(4) // only get the latest 4 authors
    .get()
    .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
            var users = doc.data();
            var usersElement = document.createElement('a');
            usersElement.href = "/users/" + doc.id; // use doc.id to get the unique identifier
            usersElement.className = "link";
            usersElement.innerHTML = `
                <img src="${users.avatar}" alt="${users.username}">
                <div class="album-details">
                    <div class="album-title">${users.username}</div>
                    <div class="album-author">${users.Occupation}</div> 
                </div>
            `;
            authorsContainer.appendChild(usersElement);
        });
    })
    .catch(error => console.error(error));

                     </script>
                








                     <div class="section-title">
                        Today's Events
                        <a href="https://yui.xioyuna.com/event-list/" class="link">View All</a>
                     </div>
                   

                     <div class="list detailed-list list-dividers full-width">
                        <ul>
                           <li>
                              <a href="#" class="item-link item-content">
                                 <div class="item-media"><img src="img/events/1.jpg" class="event-thumbnail" alt=""></div>
                                 <div class="item-inner">
                                    <div class="item-title">
                                       <div class="item-name">Art Exhibition</div>
                                       <div class="item-footer">Museum of Art, New York City</div>
                                    </div>
                                    <div class="item-after"><span class="badge color-dark">9:00 AM</span>
                                    </div>
                                 </div>
                              </a>
                           </li>
                           <li>
                              <a href="#" class="item-link item-content">
                                 <div class="item-media"><img src="img/events/2.jpg" class="event-thumbnail" alt=""></div>
                                 <div class="item-inner">
                                    <div class="item-title">
                                       <div class="item-name">Jay-Z Concert</div>
                                       <div class="item-footer">Staples Center, Los Angeles</div>
                                    </div>
                                    <div class="item-after"><span class="badge color-dark">4:00 PM</span>
                                    </div>
                                 </div>
                              </a>
                           </li>
                           <li>
                              <a href="#" class="item-link item-content">
                                 <div class="item-media"><img src="img/events/3.jpg" class="event-thumbnail" alt=""></div>
                                 <div class="item-inner">
                                    <div class="item-title">
                                       <div class="item-name">Comedy Show</div>
                                       <div class="item-footer">The Laugh Club, Chicago</div>
                                    </div>
                                    <div class="item-after"><span class="badge color-dark">6:30 PM</span>
                                    </div>
                                 </div>
                              </a>
                           </li>
                           <li>
                              <a href="#" class="item-link item-content">
                                 <div class="item-media"><img src="img/events/4.jpg" class="event-thumbnail" alt=""></div>
                                 <div class="item-inner">
                                    <div class="item-title">
                                       <div class="item-name">Dance Performance</div>
                                       <div class="item-footer">Opera House, Sydney</div>
                                    </div>
                                    <div class="item-after"><span class="badge color-dark">8:00 PM</span>
                                    </div>
                                 </div>
                              </a>
                           </li>
                           <li>
                              <a href="#" class="item-link item-content">
                                 <div class="item-media"><img src="img/events/5.jpg" class="event-thumbnail" alt=""></div>
                                 <div class="item-inner">
                                    <div class="item-title">
                                       <div class="item-name">Hard Rock Concert</div>
                                       <div class="item-footer">O2 Arena, London</div>
                                    </div>
                                    <div class="item-after"><span class="badge color-dark">9:30 PM</span>
                                    </div>
                                 </div>
                              </a>
                           </li>
                        </ul>
                     </div>





                     <div class="section-title">
                        Trending Albums
                        <a href="https://yui.xioyuna.com/album-list/" class="link">View All</a>
                     </div>
                     <swiper-container class="full-width" slides-per-view="2.4" space-between="15" slides-offset-after="15"
                        slides-offset-before="15" speed="400">
                        <swiper-slide>
                           <a href="#" data-href="/album/" class="card card-album">
                              <div class="card-image">
                                 <img src="img/albums/7.jpg" alt="">
                                 <div class="card-movie-rating">
                                    <i class="icon f7-icons text-color-yellow">star_fill</i>
                                    4.8/5
                                 </div>
                              </div>
                           </a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/album/" class="card card-album">
                              <div class="card-image">
                                 <img src="img/albums/8.jpg" alt="">
                                 <div class="card-movie-rating">
                                    <i class="icon f7-icons text-color-yellow">star_fill</i>
                                    4.3/5
                                 </div>
                              </div>
                           </a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/album/" class="card card-album">
                              <div class="card-image">
                                 <img src="img/albums/9.jpg" alt="">
                                 <div class="card-movie-rating">
                                    <i class="icon f7-icons text-color-yellow">star_fill</i>
                                    4.1/5
                                 </div>
                              </div>
                           </a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/album/" class="card card-album">
                              <div class="card-image">
                                 <img src="img/albums/10.jpg" alt="">
                                 <div class="card-movie-rating">
                                    <i class="icon f7-icons text-color-yellow">star_fill</i>
                                    4.5/5
                                 </div>
                              </div>
                           </a>
                        </swiper-slide>
                     </swiper-container>
                     <div class="section-title">
                        <span id="random-category-name-two"></span>
                        <a href="" id="view-all-link-two" class="link external">View All</a>
                     </div>
                     <div class="post-list" id="random-category-news-two">
                        <!-- News Items Go Here -->
                     </div>
                     <script>
                        // Your web app's Firebase configuration
                        
                        
                        document.addEventListener("DOMContentLoaded", function() {
                            db.collection('categories').get().then((querySnapshot) => {
                                var categories = querySnapshot.docs;
                                var randomIndex = Math.floor(Math.random() * categories.length);
                                var randomCategory = categories[randomIndex];
                                document.getElementById("random-category-name-two").textContent = "In " + randomCategory.data().name;
                                var viewAllLink = document.getElementById("view-all-link-two");
                                if (viewAllLink) {
                                    viewAllLink.href = "category.html?category=" + randomCategory.id;
                                }
                                displayNews(randomCategory.id);
                            });
                        
                        
                            function displayNews(categoryID) {
                                db.collection("news").where("categoryID", "==", categoryID).orderBy('date', 'desc').limit(3).get().then((querySnapshot) => {
                                    querySnapshot.forEach((doc) => {
                                        var newsContainer = document.querySelector('#random-category-news-two');
                        
                                        var newsEntry = document.createElement('a');
                                        newsEntry.href = "single.html?id=" + doc.id;
                                        newsEntry.className = "link post-horizontal external";
                        
                                        var infos = document.createElement('div');
                                        infos.className = "infos";
                        
                                        var category = document.createElement('div');
                                        category.className = "post-category";
                                        category.textContent = doc.data().category;
                                        infos.appendChild(category);
                        
                                        var title = document.createElement('div');
                                        title.className = "post-title";
                                        title.textContent = doc.data().title;
                                        infos.appendChild(title);
                        
                                        var date = document.createElement('div');
                                        date.className = "post-date";
                                        date.textContent = new Date(doc.data().date).toLocaleDateString();
                                        infos.appendChild(date);
                        
                                        newsEntry.appendChild(infos);
                        
                                        var image = document.createElement('div');
                                        image.className = "post-image";
                        
                                        var img = document.createElement('img');
                                        img.src = doc.data().image;
                                        image.appendChild(img);
                        
                                        newsEntry.appendChild(image);
                        
                                        newsContainer.appendChild(newsEntry);
                                    });
                                });
                            }
                        });
                     </script>
                  </div>
               </div>
            </div>


            <div class="view view-init tab tab-active view-init" id="tab-2">
               <div class="page">
                  <div class="navbar navbar-large">
                     <div class="navbar-bg"></div>
                     <div class="navbar-inner">
                        <div class="left">
                           <a href="settings" class="link icon-only navbar-profile">
                           <img src="img/avatars/small-avatar.jpg" alt="">
                           </a>
                        </div>
                        <div class="title">Latest Posts</div>
                        <div class="title-large">
                           <div class="title-large-text">Latest Posts</div>
                        </div>
                        <div class="right">
                           <a href="#" class="link icon-only switch-theme theme-switcher">
                           <i class="icon f7-icons">moon_stars</i>
                           </a>
                           <a href="notifications" class="link icon-only">
                           <i class="icon f7-icons">
                           bell
                           <span class="badge bg-color-primary">5</span>
                           </i>
                           </a>
                        </div>
                     </div>
                  </div>
                 
<style>
   @keyframes placeHolderShimmer {
  0% {
    background-position: -800px 0
  }
  100% {
    background-position: 800px 0
  }
}

.animated-background {
  animation-duration: 2s;
  animation-fill-mode: forwards;
  animation-iteration-count: infinite;
  animation-name: placeHolderShimmer;
  animation-timing-function: linear;
  background-color: #f6f7f8;
  background: linear-gradient(to right, #eeeeee 8%, #bbbbbb 18%, #eeeeee 33%);
  background-size: 800px 104px;
  height: 70px;
  position: relative;
}

.background-masker {
  background-color: #fff;
  position: absolute;
  height: 100%;
  width: 100%;
}

.btn-divide-left {
  top: 0;
  left: 25%;
  height: 100%;
  width: 5%;
}

</style>

                  <div class="page-content">

<div class="swiper-container full-width" slides-per-view="1.2" space-between="15" slides-offset-after="15" slides-offset-before="15" speed="400">
    <div class="swiper-wrapper">
        <!-- Loading Slide -->

<div class="swiper-slide swiper-slide-active" role="group" aria-label="1 / 2" style="width: 342.5px; margin-right: 15px; margin-left: 10px;">
  <a href="#" class="card external">
    <div class="card-image">
      <!-- Use a div to replace the image with a specific height -->
      <div class="animated-background" style="height: 214px; width: 100%;"></div>
      <div class="card-image-footer">
        <div class="" style="height: 20px; width: 100px;"></div> <!-- replace the category with a placeholder -->
        <div class="b" style="height: 30px; margin-top: 10px;"></div> <!-- replace the title with a placeholder -->
      </div>
    </div>
  </a>
</div>

<div class="swiper-slide swiper-slide-active" role="group" aria-label="2 / 2" style="width: 342.5px; margin-right: 15px; margin-left: 10px;">
  <a href="#" class="card external">
    <div class="card-image">
      <!-- Use a div to replace the image with a specific height -->
      <div class="animated-background" style="height: 214px; width: 100%;"></div>
      <div class="card-image-footer">
        <div class="" style="height: 20px; width: 100px;"></div> <!-- replace the category with a placeholder -->
        <div class="b" style="height: 30px; margin-top: 10px;"></div> <!-- replace the title with a placeholder -->
      </div>
    </div>
  </a>
</div>

    </div>
</div>




                     <script>
function loadLatestNews() {
    var swiperWrapper = document.querySelector('.swiper-wrapper');

    db.collection('news')
        .orderBy('date', 'desc')
        .limit(2)
        .get()
        .then((querySnapshot) => {
            // Clear the default slide
            swiperWrapper.innerHTML = '';

            querySnapshot.forEach((doc) => {
                var swiperSlide = document.createElement('div');
                swiperSlide.className = 'swiper-slide';

                var link = document.createElement('a');
                link.href = "single.html?id=" + doc.id;
                link.className = "card external";

                var cardImage = document.createElement('div');
                cardImage.className = "card-image";

                var img = document.createElement('img');
                img.src = doc.data().image;
                img.alt = "";

                var cardImageFooter = document.createElement('div');
                cardImageFooter.className = "card-image-footer";

                var cardCategory = document.createElement('div');
                cardCategory.className = "card-category bg-color-white";
                cardCategory.textContent = doc.data().categoryName;

                var title = document.createElement('h2');
                title.textContent = doc.data().title;

                cardImageFooter.appendChild(cardCategory);
                cardImageFooter.appendChild(title);

                cardImage.appendChild(img);
                cardImage.appendChild(cardImageFooter);

                link.appendChild(cardImage);

                swiperSlide.appendChild(link);

                swiperWrapper.appendChild(swiperSlide);
            });

            // Initialize Swiper after dynamically adding slides
            var swiperContainer = document.querySelector('.swiper-container');
            if (swiperContainer.swiper) {
                swiperContainer.swiper.update();
            } else {
                new Swiper(swiperContainer, {
                    slidesPerView: '1.2',
                    spaceBetween: 15,
                    slidesOffsetAfter: 15,
                    slidesOffsetBefore: 15,
                    speed: 400
                });
            }
        })
        .catch((error) => {
            console.log("Error getting documents: ", error);
        });
}

// Call the function to load the news
loadLatestNews();

                        
                     </script>
                     <div class="section-title">
                        Popular Posts
                        <a href="categories.html" class="link external">View All</a>
                     </div>

<div class="post-list" id="popular-news"></div>


                     <script>
      function loadPopularNews() {
  var popularNewsContainer = document.querySelector('#popular-news');

  // Display 3 skeleton loaders while fetching the data
  for (var i = 0; i < 3; i++) {
    popularNewsContainer.innerHTML += `
    <div class="link post-horizontal external">
      <div class="infos">
        <div class="animated-background" style="height: 20px; width: 50px; margin-bottom: 5px;"></div>
        <div class="animated-background" style="height: 30px; width: 100%; margin-bottom: 5px;"></div>
        <div class="animated-background" style="height: 20px; width: 70px;"></div>
      </div>
      <div class="post-image">
        <div class="animated-background" style="height: 100px; width: 100px;"></div>
      </div>
    </div>`;
  }

  // Fetch the top 3 popular news from Firestore
  db.collection('news').orderBy('views', 'desc').limit(3).get()
    .then((querySnapshot) => {
      // Clear the skeleton loaders
      popularNewsContainer.innerHTML = '';

      // Add the actual news items
      querySnapshot.forEach((doc) => {
        console.log(doc.data());  // Add this line
        var newsItem = document.createElement('a');
        newsItem.href = "single.html?id=" + doc.id;
        newsItem.classList.add("link", "post-horizontal", "external");

        var infos = document.createElement('div');
        infos.classList.add('infos');

        var category = document.createElement('div');
        category.classList.add('post-category');
        category.textContent = doc.data().category;

        var title = document.createElement('div');
        title.classList.add('post-title');
        title.textContent = doc.data().title;

        var date = document.createElement('div');
        date.classList.add('post-date');
        date.textContent = doc.data().date;

        var imgContainer = document.createElement('div');
        imgContainer.classList.add('post-image');

        var img = document.createElement('img');
        img.src = doc.data().image;
        img.alt = "";

        imgContainer.appendChild(img);
        infos.appendChild(category);
        infos.appendChild(title);
        infos.appendChild(date);
        newsItem.appendChild(infos);
        newsItem.appendChild(imgContainer);
        popularNewsContainer.appendChild(newsItem);
      });
    }).catch((error) => {
      console.log("Error getting documents: ", error);
    });
}

// Call the function to load the popular news
loadPopularNews();

                            
                     </script>
 





                     <div class="section-title">Post Of The Month</div>
                     <a href="https://yui.xioyuna.com/single/" class="card">
                        <div class="card-image">
                           <img src="img/cards/4.jpg" alt="">
                           <div class="card-image-footer">
                              <div class="card-category bg-color-white">Science</div>
                              <h2>Exploring the Adaptations and Behaviors of these Majestic Birds</h2>
                           </div>
                        </div>
                     </a>
                     <div class="section-title">
                        <span id="random-category-name"></span>
                        <a href="" id="view-all-link" class="link external">View All</a>
                     </div>
                     <div class="post-list" id="random-category-news">
                        <!-- News Items Go Here -->
                     </div>
                     <script>
                        // Your web app's Firebase configuration
                       document.addEventListener("DOMContentLoaded", function() {
    var newsContainer = document.querySelector('#random-category-news');
    
    // Display 3 skeleton loaders while fetching the data
    for (var i = 0; i < 3; i++) {
        newsContainer.innerHTML += `
        <div class="link post-horizontal external">
          <div class="infos">
            <div class="animated-background" style="height: 20px; width: 50px; margin-bottom: 5px;"></div>
            <div class="animated-background" style="height: 30px; width: 100%; margin-bottom: 5px;"></div>
            <div class="animated-background" style="height: 20px; width: 70px;"></div>
          </div>
          <div class="post-image">
            <div class="animated-background" style="height: 100px; width: 100px;"></div>
          </div>
        </div>`;
    }

    db.collection('categories').get().then((querySnapshot) => {
        var categories = querySnapshot.docs;
        var randomIndex = Math.floor(Math.random() * categories.length);
        var randomCategory = categories[randomIndex];
        document.getElementById("random-category-name").textContent = "In " + randomCategory.data().name;
        var viewAllLink = document.getElementById("view-all-link");
        if (viewAllLink) {
            viewAllLink.href = "category.html?category=" + randomCategory.id;
        }
        displayNews(randomCategory.id);
    });


    function displayNews(categoryID) {
        db.collection("news").where("categoryID", "==", categoryID).orderBy('date', 'desc').limit(3).get().then((querySnapshot) => {
            // Clear the skeleton loaders
            newsContainer.innerHTML = '';

            // Add the actual news items
            querySnapshot.forEach((doc) => {
                var newsEntry = document.createElement('a');
                newsEntry.href = "single.html?id=" + doc.id;
                newsEntry.className = "link post-horizontal external";

                var infos = document.createElement('div');
                infos.className = "infos";

                var category = document.createElement('div');
                category.className = "post-category";
                category.textContent = doc.data().category;
                infos.appendChild(category);

                var title = document.createElement('div');
                title.className = "post-title";
                title.textContent = doc.data().title;
                infos.appendChild(title);

                var date = document.createElement('div');
                date.className = "post-date";
                date.textContent = new Date(doc.data().date).toLocaleDateString();
                infos.appendChild(date);

                newsEntry.appendChild(infos);

                var image = document.createElement('div');
                image.className = "post-image";

                var img = document.createElement('img');
                img.src = doc.data().image;
                image.appendChild(img);

                newsEntry.appendChild(image);

                newsContainer.appendChild(newsEntry);
            });
        });
    }
});

                     </script>
                     <div class="section-title">Trending Topics</div>
                     <swiper-container class="full-width categories-slider" slides-per-view="auto" space-between="10"
                        slides-offset-after="15" slides-offset-before="15" speed="400">
                        <swiper-slide>
                           <a href="#" data-href="/post-list/" class="link category-slide">Sports</a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/post-list/" class="link category-slide">Technology</a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/post-list/" class="link category-slide">Politics</a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/post-list/" class="link category-slide">Economics</a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/post-list/" class="link category-slide">Science</a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/post-list/" class="link category-slide">Fashion</a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/post-list/" class="link category-slide">Art</a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/post-list/" class="link category-slide">Music</a>
                        </swiper-slide>
                        <swiper-slide>
                           <a href="#" data-href="/post-list/" class="link category-slide">Travel</a>
                        </swiper-slide>
                     </swiper-container>
                     <div class="section-title">
                        Suggested Categories
                        <a href="categories.html" class="link external">Browse All</a>
                     </div>
                     <div class="grid grid-cols-2 grid-gap" id="category-container">
                        <!-- Categories will be dynamically added here -->
                     </div>
                     <script>
                        // Your web app's Firebase configuration
                        
                        
                        function loadCategories() {
                        var categoryContainer = document.querySelector('#category-container');
                        
                        db.collection('categories').limit(6).get()
                            .then((querySnapshot) => {
                                querySnapshot.forEach((doc) => {
                                    var categoryItem = document.createElement('a');
                                    // Redirect to category.html with category as a parameter
                                    categoryItem.href = `category.html?category=${doc.id}`;
                                    categoryItem.className = "category-item link external";
                        
                                    var img = document.createElement('img');
                                    img.src = doc.data().imageUrl;
                                    img.alt = doc.data().name;
                        
                                    var categoryName = document.createElement('div');
                                    categoryName.className = "category-name";
                                    categoryName.textContent = doc.data().name;
                        
                                    categoryItem.appendChild(img);
                                    categoryItem.appendChild(categoryName);
                                    categoryContainer.appendChild(categoryItem);
                                });
                            }).catch((error) => {
                                console.log("Error getting documents: ", error);
                            });
                        }
                        
                        // Call the function to load the categories
                        loadCategories();
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        // create categori
                        
                        // function populateCategories() {
                        //     var categories = ['Travel', 'Health', 'Food', 'Environment', 'Art', 'Science'];
                        //     var client_id = 'vZPoDIrMKfeBTWFFTdNyv4zrNrZ-b6OJlRiPyjHYP7Q';
                        
                        //     categories.forEach((category) => {
                        //         // Fetch a random image from Unsplash for each category
                        //         fetch(`https://api.unsplash.com/photos/random?client_id=${client_id}`)
                        //             .then(response => response.json())
                        //             .then(data => {
                        //                 // Add the category to Firestore
                        //                 db.collection('categories').add({
                        //                     name: category,
                        //                     imageUrl: data.urls.small
                        //                 })
                        //                 .then((docRef) => {
                        //                     console.log('Document written with ID: ', docRef.id);
                        //                 })
                        //                 .catch((error) => {
                        //                     console.error('Error adding document: ', error);
                        //                 });
                        //             })
                        //             .catch(error => console.log('Error fetching image: ', error));
                        //     });
                        // }
                        
                        // populateCategories();
                        
                        
                     </script>
                  </div>
               </div>
            </div>






            <div class="view view-init tab" id="tab-3">
               <div class="page">
                  <div class="navbar navbar-large">
                     <div class="navbar-bg"></div>
                     <div class="navbar-inner">
                        <div class="left">
                           <a href="settings" class="link icon-only navbar-profile">
                           <img src="img/avatars/small-avatar.jpg" alt="">
                           </a>
                        </div>
                        <div class="title">Pages</div>
                        <div class="title-large">
                           <div class="title-large-text">Pages</div>
                        </div>
                        <div class="right">
                           <a href="#" class="link icon-only switch-theme theme-switcher">
                           <i class="icon f7-icons">moon_stars</i>
                           </a>
<a href="notifications" class="link icon-only" onclick="changeUsername()">
 <i class="icon f7-icons tooltip-init" data-tooltip="gear_alt">gear_alt</i>
</a>




                        </div>
                     </div>
                  </div>


<div class="page no-toolbar page-current" data-name="chat">
  <div class="toolbar messagebar messagebar-init" style="margin-bottom: 50px;">
    <div class="toolbar-inner">
      <input type="file" id="imageUpload" accept="image/*" style="display: none">
      <a class="link" onclick="document.getElementById('imageUpload').click()">
        <i class="icon f7-icons">camera_fill</i>
      </a>
      <div class="messagebar-area">
        <textarea placeholder="Message"></textarea>
      </div>
      <a href="#" class="link send-link">
        <i class="icon f7-icons">paperplane_fill</i>
      </a>
    </div>
  </div>



  <div class="page-content messages-content">

    <div class="messages full-width" style="margin-bottom: 50px;"></div>
  </div>

</div>



<script>

let user;
let username;
let avatar = "img/avatars/1.jpg"; // default avatar

if(localStorage.getItem("user")) { //check if there's a logged in user
    user = JSON.parse(localStorage.getItem('user'));
    username = user.username; //get username from user object in localstorage
    avatar = user.avatar || avatar; //get avatar from user object in localstorage
}

function changeUsername(){
    Swal.fire({
        title: 'Change Username',
        input: 'text',
        inputLabel: 'New Username',
        inputPlaceholder: 'Enter new username',
        showCancelButton: true,
        confirmButtonText: 'Change',
        preConfirm: (newUsername) => {
            if (!newUsername) {
                Swal.showValidationMessage('Username should not be empty')
            }
        }
    }).then((result) => {
        if (result.isConfirmed) {
            username = result.value;
            user.username = username;
            localStorage.setItem("user", JSON.stringify(user));
            Swal.fire('Success!', 'Username changed successfully!', 'success');
        }
    })
}

let messages = document.querySelector('.messages');
let newMessageSound = new Audio('call.mp3');

db.collection("chat")
    .orderBy("timestamp", "desc")
    .limit(15)
    .onSnapshot((querySnapshot) => {
        messages.innerHTML = "";
        let docs = querySnapshot.docs;
        // Reverse the messages to display the latest at the bottom
        for(let i = docs.length - 1; i >= 0; i--) {
            let message = docs[i].data();
            if (message.image) {
                messages.innerHTML += `
                    <div class="message message-received message-first message-last">
                        <div class="message-avatar" style="background-image: url('${message.avatar}')"></div>
                        <div class="message-content">
                            <div class="message-bubble">
                                <div class="message-image"><img src="${message.image}" /></div>
                                <div class="message-text"><b>${message.username}:</b></div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                messages.innerHTML += `
                    <div class="message message-received message-first message-last">
                        <div class="message-avatar" style="background-image: url('${message.avatar}')"></div>
                        <div class="message-content">
                            <div class="message-bubble">
                                <div class="message-text"><b>${message.username}:</b> ${message.text}</div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }
        // Scroll to the latest message
        setTimeout(function() {
            messages.lastElementChild.scrollIntoView({behavior: 'smooth'});
            newMessageSound.play();
        }, 100);
    });

let sendMessage = document.querySelector('.send-link');
let imageUpload = document.getElementById('imageUpload');

sendMessage.addEventListener('click', () => {
    if(localStorage.getItem("user")) { // Check if user is logged in
        let text = document.querySelector('.messagebar-area textarea').value;
        if (text.trim() !== '') {
            db.collection('chat').add({
                text: text,
                timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                avatar: avatar,
                username: username
            });
            document.querySelector('.messagebar-area textarea').value = "";
        }
    } else {
        // Redirect to login.html
        window.location.href = "login.html";
    }
});

imageUpload.addEventListener('change', (e) => {
    let file = e.target.files[0];
    let reader = new FileReader();
    
    reader.onloadend = function() {
        db.collection('chat').add({
            image: reader.result,
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
            avatar: avatar,
            username: username
        });
    }
    if (file) {
        reader.readAsDataURL(file);
    }
});

window.onload = function() {
    document.getElementById('user-avatar').src = avatar;
    document.getElementById('user-name').textContent = username || "Guest";
    document.getElementById('user-email').textContent = user ? user.email : "";

    if(!user){
        let loginLink = document.createElement('a');
        loginLink.href = "login.html";
        loginLink.textContent = "Log In";
        loginLink.className = "link edit-profile-image";
        
        document.querySelector('.settings-header').appendChild(loginLink);
    }

    document.getElementById('edit-avatar-icon').addEventListener('click', function(e) {
        e.preventDefault();
        
        let avatarUpload = document.getElementById('avatar-upload');
        avatarUpload.click();

        avatarUpload.addEventListener('change', function() {
            let file = avatarUpload.files[0];
            let reader = new FileReader();
            
            reader.onloadend = function() {
                document.getElementById('user-avatar').src = reader.result;
                
                user.avatar = reader.result;
                avatar = reader.result;
                localStorage.setItem('user', JSON.stringify(user));
            };

            reader.readAsDataURL(file);
        });
    });
}


</script>


               </div>
            </div>


            <div class="view view-init tab" id="tab-4">
               <div class="page">
                  <div class="navbar navbar-large">
                     <div class="navbar-bg"></div>
                     <div class="navbar-inner">
                        <div class="left">
                           <a href="settings" class="link icon-only navbar-profile">
                           <img src="img/avatars/small-avatar.jpg" alt="">
                           </a>
                        </div>
                        <div class="title">Components</div>
                        <div class="title-large">
                           <div class="title-large-text">Components</div>
                        </div>
                        <div class="right">
                           <a href="#" class="link icon-only switch-theme theme-switcher">
                           <i class="icon f7-icons">moon_stars</i>
                           </a>
                           <a href="notifications" class="link icon-only">
                           <i class="icon f7-icons">
                           bell
                           <span class="badge bg-color-primary">5</span>
                           </i>
                           </a>
                        </div>
                     </div>
                  </div>
                  


                  <div class="page-content">
                    
                    <!-- tab 4 tab4 -->

              
                  </div>







               </div>
            </div>


            <div class="view view-init tab" id="tab-5">
               <div class="page">
                  <div class="navbar navbar-large">
                     <div class="navbar-bg"></div>
                     <div class="navbar-inner">
                        <div class="left">
                           <a href="settings" class="link icon-only navbar-profile">
                           <img src="img/avatars/small-avatar.jpg" alt="">
                           </a>
                        </div>
                        
                     
                        <div class="right">
                           <a href="#" class="link icon-only switch-theme theme-switcher">
                           <i class="icon f7-icons">moon_stars</i>
                           </a>
                           <a href="notifications" class="link icon-only">
<i class="icon f7-icons tooltip-init" data-tooltip="Setting">gear_alt</i>
                           </a>
                        </div>
                     </div>
                  </div>
                 

                  <div class="page-content">
   


<div class="settings-header">
    <div class="settings-image">
        <img id="user-avatar" src="img/avatars/1.jpg" alt="" class="">
        <a href="#" id="edit-profile-link" class="link edit-profile-image">
            <i id="edit-icon" class="icon f7-icons">pencil</i>
        </a>
        <input type="file" id="avatar-upload" style="display: none;">
    </div>
    <div id="user-name" class="settings-name">Noah Campbell</div>
    <div id="user-email" class="settings-email">ncampbell@envato.com</div>
</div>

<script>
// Update avatar in all navbar-profile links
function handleProfileImages(avatar) {
    // Select all navbar-profile links
    let profileImages = document.querySelectorAll('.navbar-profile');

    profileImages.forEach(profileImage => {
        // Set image source based on login status
        let imgElement = profileImage.querySelector('img');
        imgElement.src = avatar || 'img/avatars/small-avatar.jpg';
        
        // Add click event
        profileImage.addEventListener('click', (e) => {
            if (!user) {
                // Prevent default link action
                e.preventDefault();
                // Redirect to login.html
                window.location.href = 'login.html';
            }
        });
    });
}

window.onload = function() {
    // Fetch user data from Firestore
    let username = localStorage.getItem('username');
    if (username) {
        db.collection('users').doc(username).get()
        .then((doc) => {
            if (doc.exists) {
                // Update user data in localStorage
                localStorage.setItem('user', JSON.stringify(doc.data()));
            }
        })
        .catch((error) => {
            console.error("Error getting document:", error);
        });
    }

    let user = JSON.parse(localStorage.getItem('user'));

    if (user) {
        // User is logged in, show user info
        document.getElementById('user-avatar').src = user.avatar || "img/avatars/1.jpg";
        document.getElementById('user-name').textContent = user.username || "Noah Campbell";
        document.getElementById('user-email').textContent = user.email || "ncampbell@envato.com";

        document.getElementById('edit-icon').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('avatar-upload').click();
        });

        document.getElementById('avatar-upload').addEventListener('change', function(e) {
            let file = e.target.files[0];
            let storageRef = firebase.storage().ref('avatars/' + file.name);

            let uploadTask = storageRef.put(file);

            uploadTask.on('state_changed', 
            (snapshot) => { 
                // track the upload progress
            }, (error) => {
                // handle upload errors
                console.error('Upload failed:', error);
            }, () => {
                // get the download URL and update user's avatar in Firestore
                uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                    user.avatar = downloadURL;
                    localStorage.setItem('user', JSON.stringify(user));
                    document.getElementById('user-avatar').src = downloadURL;

                    // Also update the avatar in Firestore user document
                    db.collection('users').doc(user.username).set({
                        avatar: downloadURL
                    }, { merge: true });

                    // Update the profile images
                    handleProfileImages(downloadURL);
                });
            });
        });
    } else {
        // User is not logged in, show default image and login button
        document.getElementById('user-avatar').src = "img/avatars/1.jpg";
        document.getElementById('user-name').textContent = "Guest";
        document.getElementById('user-email').textContent = "";

        let loginLink = document.createElement('a');
        loginLink.href = "login.html";
        loginLink.textContent = "Log In";
        loginLink.className = "link edit-profile-image";
        
        document.querySelector('.settings-header').appendChild(loginLink);
    }

    // Handle the profile images
    handleProfileImages(user ? user.avatar : null);
}

</script>







    <div class="list links-list colored-icons-list settings-list list-outline list-dividers full-width">
      <ul>
        <li>
          <a href="#" class="">
            <div class="colored-icon blue">
              <i class="icon f7-icons">globe</i>
            </div>
            Language
            <div class="item-after">English</div>
          </a>
        </li>
        <li class="item-content">
          <div class="item-inner">
            <div class="colored-icon red">
              <i class="icon f7-icons">bell_fill</i>
            </div>
            <div class="item-title">Notifications</div>
            <div class="item-after">
              <label class="toggle toggle-init color-green">
                <input type="checkbox" checked="">
                <span class="toggle-icon"></span>
              </label>
            </div>
          </div>
        </li>
        <li class="item-content">
          <div class="item-inner">
            <div class="colored-icon orange">
              <i class="icon f7-icons">location_fill</i>
            </div>
            <div class="item-title">Location</div>
            <div class="item-after">
              <label class="toggle toggle-init color-green">
                <input type="checkbox" checked="">
                <span class="toggle-icon"></span>
              </label>
            </div>
          </div>
        </li>
        <li class="item-content">
          <div class="item-inner">
            <div class="colored-icon blue">
              <i class="icon f7-icons">hand_raised_fill</i>
            </div>
            <div class="item-title">Private Mode</div>
            <div class="item-after">
              <label class="toggle toggle-init color-green">
                <input type="checkbox">
                <span class="toggle-icon"></span>
              </label>
            </div>
          </div>
        </li>
        <li class="item-content">
          <div class="item-inner">
            <div class="colored-icon pink">
              <i class="icon f7-icons">speaker_2_fill</i>
            </div>
            <div class="item-title">Sounds</div>
            <div class="item-after">
              <label class="toggle toggle-init color-green">
                <input type="checkbox" checked="">
                <span class="toggle-icon"></span>
              </label>
            </div>
          </div>
        </li>
        <li>
          <a href="#" class="">
            <div class="colored-icon blue">
              <i class="icon f7-icons">shield_lefthalf_fill</i>
            </div>
            Privacy &amp; Security
          </a>
        </li>
        <li>
          <a href="#" class="">
            <div class="colored-icon orange">
              <i class="icon f7-icons">arrow_2_circlepath</i>
            </div>
            Updates
            <div class="item-after">Automatic</div>
          </a>
        </li>
        <li>
          <a href="#" class="">
            <div class="colored-icon gray">
              <i class="icon f7-icons">gear</i>
            </div>
            Version
            <div class="item-after">v2.3.7</div>
          </a>
        </li>
        <li>
          <a href="#">
            <div class="colored-icon green">
              <i class="icon f7-icons">doc_text_fill</i>
            </div>
            Terms Of Service
          </a>
        </li>
        <li>
          <a href="#">
            <div class="colored-icon purple">
              <i class="icon f7-icons">star_fill</i>
            </div>
            Rate The App
          </a>
        </li>
      </ul>
    </div>
  </div>




               </div>
            </div>



            <div class="toolbar tabbar tabbar-icons toolbar-bottom">
               <div class="toolbar-inner">
                  <a href="#tab-1" class="tab-link">
                  <i class="icon f7-icons">sparkles</i>
                  <span class="tabbar-label">Discover</span>
                  </a>
                  <a href="#tab-2" class="tab-link tab-link-active">
                  <i class="icon f7-icons">rocket</i>
                  <span class="tabbar-label">News</span>
                  </a>
                
             <a href="#tab-3" id="chat-tab" class="tab-link">
                 <i class="icon f7-icons tooltip-init" data-tooltip="chat_bubble">chat_bubble 
                  <!-- <span id="unread-badge" class="badge bg-color-primary">77</span> -->
               </i>
                  <span class="tabbar-label">Chat</span>
                  </a>

        <!--           <a href="#tab-4" class="tab-link">
                  <i class="icon f7-icons">rectangle_on_rectangle_angled</i>
                  <span class="tabbar-label">Components</span>
                  </a> -->
                  <a href="#tab-5" class="tab-link">
                 <i class="icon f7-icons tooltip-init" data-tooltip="person_alt_circle">person_alt_circle</i>
                  <span class="tabbar-label">Profile</span>
                  </a>
               </div>
            </div>
         </div>
      </div>


<script>

// On page load, get the current theme from local storage and apply it
document.body.className = localStorage.getItem('theme') || 'color-blue';

// Get all switchers
let switchers = document.querySelectorAll('.theme-switcher');

// Add the click event listener to all switchers
switchers.forEach(switcher => {
    switcher.addEventListener('click', function(e) {
        e.preventDefault();

        if (document.body.className === 'color-blue') {
            document.body.className = 'color-blue dark';
            localStorage.setItem('theme', 'color-blue dark');
        } else {
            document.body.className = 'color-blue';
            localStorage.setItem('theme', 'color-blue');
        }

        // Refresh the page
        location.reload();
    });
});


</script>




      <script data-cfasync="false" src="../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="js/framework7-bundle.min.js"></script>

      <script src="js/app.js"></script>
   </body>
</html>